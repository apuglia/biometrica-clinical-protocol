{"version":3,"sources":["../../../../src/app/playground/page.tsx","../../../../protocol/protocol.ts","../../../../lib/engine.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { protocolRules } from \"../../../protocol/protocol\";\r\nimport { generateReport } from \"../../../lib/engine\";\r\nimport { LabInput } from \"../../../lib/types\";\r\nimport normalFixture from \"../../../fixtures/normal.json\";\r\nimport cardioRiskFixture from \"../../../fixtures/cardio_risk.json\";\r\nimport thyroidFixture from \"../../../fixtures/thyroid.json\";\r\nimport inflammationFixture from \"../../../fixtures/inflammation.json\";\r\nimport anemiaFixture from \"../../../fixtures/anemia.json\";\r\nimport redflagFixture from \"../../../fixtures/redflag.json\";\r\n\r\nconst fixtures = {\r\n  normal: normalFixture as LabInput,\r\n  cardio_risk: cardioRiskFixture as LabInput,\r\n  thyroid: thyroidFixture as LabInput,\r\n  inflammation: inflammationFixture as LabInput,\r\n  anemia: anemiaFixture as LabInput,\r\n  redflag: redflagFixture as LabInput,\r\n};\r\n\r\nconst fixtureLabels: Record<keyof typeof fixtures, string> = {\r\n  normal: \"Normal\",\r\n  cardio_risk: \"Riesgo Cardiovascular\",\r\n  thyroid: \"Tiroides\",\r\n  inflammation: \"Inflamación\",\r\n  anemia: \"Anemia\",\r\n  redflag: \"Red Flags (Emergencia)\",\r\n};\r\n\r\nconst severityColors: Record<string, { bg: string; text: string; border: string }> = {\r\n  red: { bg: \"#fee2e2\", text: \"#991b1b\", border: \"#dc2626\" },\r\n  orange: { bg: \"#fed7aa\", text: \"#9a3412\", border: \"#ea580c\" },\r\n  yellow: { bg: \"#fef3c7\", text: \"#78350f\", border: \"#d97706\" },\r\n  green: { bg: \"#d1fae5\", text: \"#065f46\", border: \"#10b981\" },\r\n};\r\n\r\nexport default function PlaygroundPage() {\r\n  const [selectedFixture, setSelectedFixture] = useState<keyof typeof fixtures>(\"normal\");\r\n\r\n  const currentInput = fixtures[selectedFixture];\r\n  const report = generateReport(currentInput, protocolRules);\r\n\r\n  return (\r\n    <div style={{ padding: \"2rem\", maxWidth: \"1400px\", margin: \"0 auto\", fontFamily: \"system-ui, sans-serif\" }}>\r\n      <h1 style={{ fontSize: \"2rem\", fontWeight: \"bold\", marginBottom: \"1rem\" }}>\r\n        Clinical Rules Engine — Playground\r\n      </h1>\r\n\r\n      <div style={{ marginBottom: \"2rem\" }}>\r\n        <label htmlFor=\"fixture-select\" style={{ display: \"block\", marginBottom: \"0.5rem\", fontWeight: \"500\" }}>\r\n          Selecciona un fixture:\r\n        </label>\r\n        <select\r\n          id=\"fixture-select\"\r\n          value={selectedFixture}\r\n          onChange={(e) => setSelectedFixture(e.target.value as keyof typeof fixtures)}\r\n          style={{\r\n            padding: \"0.5rem 1rem\",\r\n            fontSize: \"1rem\",\r\n            border: \"1px solid #ccc\",\r\n            borderRadius: \"4px\",\r\n            minWidth: \"250px\",\r\n          }}\r\n        >\r\n          {Object.entries(fixtureLabels).map(([key, label]) => (\r\n            <option key={key} value={key}>\r\n              {label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div style={{ display: \"grid\", gridTemplateColumns: \"1fr 1fr\", gap: \"2rem\", marginBottom: \"2rem\" }}>\r\n        {/* Input JSON */}\r\n        <div>\r\n          <h2 style={{ fontSize: \"1.5rem\", fontWeight: \"600\", marginBottom: \"1rem\" }}>Input JSON</h2>\r\n          <pre\r\n            style={{\r\n              background: \"#f5f5f5\",\r\n              padding: \"1rem\",\r\n              borderRadius: \"4px\",\r\n              overflow: \"auto\",\r\n              fontSize: \"0.875rem\",\r\n              border: \"1px solid #ddd\",\r\n              maxHeight: \"400px\",\r\n            }}\r\n          >\r\n            {JSON.stringify(currentInput, null, 2)}\r\n          </pre>\r\n        </div>\r\n\r\n        {/* Stats */}\r\n        <div>\r\n          <h2 style={{ fontSize: \"1.5rem\", fontWeight: \"600\", marginBottom: \"1rem\" }}>Estadísticas</h2>\r\n          <div style={{ background: \"#f9fafb\", padding: \"1rem\", borderRadius: \"4px\", border: \"1px solid #ddd\" }}>\r\n            <p>\r\n              <strong>Reglas disparadas:</strong> {report.priorities.length}\r\n            </p>\r\n            <p>\r\n              <strong>Severidad máxima:</strong>{\" \"}\r\n              {report.priorities[0]?.then.severity || \"ninguna\"}\r\n            </p>\r\n            <p>\r\n              <strong>Biomarcadores presentes:</strong> {Object.keys(currentInput.labs).length}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Priorities */}\r\n      <div style={{ marginBottom: \"2rem\" }}>\r\n        <h2 style={{ fontSize: \"1.5rem\", fontWeight: \"600\", marginBottom: \"1rem\" }}>Prioridades</h2>\r\n        {report.priorities.length === 0 ? (\r\n          <p style={{ color: \"#666\", fontStyle: \"italic\" }}>No se dispararon reglas</p>\r\n        ) : (\r\n          <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"1rem\" }}>\r\n            {report.priorities.map((rule) => {\r\n              const severity = rule.then.severity;\r\n              const colors = severityColors[severity];\r\n              return (\r\n                <div\r\n                  key={rule.id}\r\n                  style={{\r\n                    border: `2px solid ${colors.border}`,\r\n                    borderRadius: \"8px\",\r\n                    padding: \"1rem\",\r\n                    background: colors.bg,\r\n                  }}\r\n                >\r\n                  <div style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", marginBottom: \"0.5rem\" }}>\r\n                    <span\r\n                      style={{\r\n                        background: colors.border,\r\n                        color: \"white\",\r\n                        padding: \"0.25rem 0.75rem\",\r\n                        borderRadius: \"4px\",\r\n                        fontSize: \"0.875rem\",\r\n                        fontWeight: \"600\",\r\n                        textTransform: \"uppercase\",\r\n                      }}\r\n                    >\r\n                      {severity}\r\n                    </span>\r\n                    <span style={{ fontSize: \"0.875rem\", color: \"#666\" }}>{rule.name}</span>\r\n                  </div>\r\n                  <h3 style={{ fontSize: \"1.125rem\", fontWeight: \"600\", marginBottom: \"0.5rem\", color: colors.text }}>\r\n                    {rule.then.headline}\r\n                  </h3>\r\n                  {rule.then.why && (\r\n                    <p style={{ marginBottom: \"0.75rem\", color: \"#555\" }}>{rule.then.why}</p>\r\n                  )}\r\n                  <div style={{ marginBottom: \"0.75rem\" }}>\r\n                    <strong style={{ display: \"block\", marginBottom: \"0.25rem\" }}>Acciones recomendadas:</strong>\r\n                    <ul style={{ marginLeft: \"1.5rem\", color: \"#444\" }}>\r\n                      {rule.then.doNext.map((action, idx) => (\r\n                        <li key={idx}>{action}</li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                  <details style={{ marginTop: \"0.5rem\" }}>\r\n                    <summary style={{ cursor: \"pointer\", color: \"#666\", fontSize: \"0.875rem\" }}>\r\n                      Why it fired (debug)\r\n                    </summary>\r\n                    <ul style={{ marginLeft: \"1.5rem\", marginTop: \"0.5rem\", fontSize: \"0.875rem\", color: \"#555\" }}>\r\n                      {rule.firedBecause.map((reason, idx) => (\r\n                        <li key={idx}>{reason}</li>\r\n                      ))}\r\n                    </ul>\r\n                  </details>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Action Plan */}\r\n      <div style={{ marginBottom: \"2rem\" }}>\r\n        <h2 style={{ fontSize: \"1.5rem\", fontWeight: \"600\", marginBottom: \"1rem\" }}>Plan de Acción</h2>\r\n        {report.actions.length === 0 ? (\r\n          <p style={{ color: \"#666\", fontStyle: \"italic\" }}>No hay acciones recomendadas</p>\r\n        ) : (\r\n          <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(auto-fit, minmax(300px, 1fr))\", gap: \"1rem\" }}>\r\n            {report.actions.map((action, idx) => {\r\n              const colors = severityColors[action.severity];\r\n              return (\r\n                <div\r\n                  key={idx}\r\n                  style={{\r\n                    border: `1px solid ${colors.border}`,\r\n                    borderRadius: \"8px\",\r\n                    padding: \"1rem\",\r\n                    background: colors.bg,\r\n                  }}\r\n                >\r\n                  <div style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", marginBottom: \"0.5rem\" }}>\r\n                    <span\r\n                      style={{\r\n                        background: colors.border,\r\n                        color: \"white\",\r\n                        padding: \"0.25rem 0.75rem\",\r\n                        borderRadius: \"4px\",\r\n                        fontSize: \"0.75rem\",\r\n                        fontWeight: \"600\",\r\n                        textTransform: \"uppercase\",\r\n                      }}\r\n                    >\r\n                      {action.severity}\r\n                    </span>\r\n                  </div>\r\n                  <h3 style={{ fontSize: \"1rem\", fontWeight: \"600\", marginBottom: \"0.75rem\", color: colors.text }}>\r\n                    {action.headline}\r\n                  </h3>\r\n                  <ul style={{ marginLeft: \"1.5rem\", fontSize: \"0.875rem\", color: \"#444\" }}>\r\n                    {action.bullets.map((bullet, bulletIdx) => (\r\n                      <li key={bulletIdx} style={{ marginBottom: \"0.25rem\" }}>\r\n                        {bullet}\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","import { Rule } from \"../lib/types\";\r\n\r\nexport const protocolRules: Rule[] = [\r\n  // ========== RED FLAGS ==========\r\n  {\r\n    id: \"redflag_glucose_critical\",\r\n    enabled: true,\r\n    name: \"Glucosa críticamente alta\",\r\n    when: {\r\n      all: [{ biomarker: \"glucose\", op: \">=\", value: 400 }],\r\n    },\r\n    then: {\r\n      severity: \"red\",\r\n      headline: \"Glucosa críticamente elevada: requiere atención inmediata\",\r\n      why: \"Los niveles de glucosa superan 400 mg/dL, lo cual puede indicar una emergencia médica\",\r\n      doNext: [\r\n        \"Busca atención médica urgente\",\r\n        \"No conduzcas ni realices actividades que requieran concentración\",\r\n        \"Mantente hidratado con agua\",\r\n        \"Si tienes diabetes, contacta a tu endocrinólogo inmediatamente\",\r\n      ],\r\n      doctorQuestions: [\r\n        \"¿Tienes síntomas de cetoacidosis o hiperglucemia hiperosmolar?\",\r\n        \"¿Estás tomando medicamentos para la diabetes?\",\r\n        \"¿Has tenido episodios previos similares?\",\r\n      ],\r\n      tags: [\"emergencia\", \"glucosa\", \"diabetes\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"redflag_potassium_critical\",\r\n    enabled: true,\r\n    name: \"Potasio críticamente alto\",\r\n    when: {\r\n      all: [{ biomarker: \"potassium\", op: \">=\", value: 6.5 }],\r\n    },\r\n    then: {\r\n      severity: \"red\",\r\n      headline: \"Potasio críticamente elevado: riesgo cardíaco\",\r\n      why: \"Los niveles de potasio superan 6.5 mEq/L, lo cual puede causar arritmias cardíacas peligrosas\",\r\n      doNext: [\r\n        \"Busca atención médica urgente\",\r\n        \"No tomes suplementos de potasio\",\r\n        \"Evita alimentos altos en potasio hasta consultar con médico\",\r\n        \"Informa sobre medicamentos que puedas estar tomando (IECA, ARA-II, diuréticos ahorradores de potasio)\",\r\n      ],\r\n      doctorQuestions: [\r\n        \"¿Tienes síntomas como debilidad muscular o palpitaciones?\",\r\n        \"¿Tienes función renal alterada?\",\r\n        \"¿Estás tomando medicamentos que afecten el potasio?\",\r\n      ],\r\n      tags: [\"emergencia\", \"electrolitos\", \"cardíaco\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"redflag_creatinine_critical\",\r\n    enabled: true,\r\n    name: \"Función renal críticamente alterada\",\r\n    when: {\r\n      all: [{ biomarker: \"creatinine\", op: \">=\", value: 3.0 }],\r\n    },\r\n    then: {\r\n      severity: \"red\",\r\n      headline: \"Función renal severamente alterada\",\r\n      why: \"La creatinina está muy elevada, indicando posible insuficiencia renal aguda o crónica avanzada\",\r\n      doNext: [\r\n        \"Consulta con un nefrólogo urgentemente\",\r\n        \"Revisa medicamentos que puedan afectar la función renal\",\r\n        \"Mantén una hidratación adecuada (si no hay restricción médica)\",\r\n        \"Monitorea presión arterial regularmente\",\r\n      ],\r\n      doctorQuestions: [\r\n        \"¿Tienes antecedentes de enfermedad renal?\",\r\n        \"¿Has tenido cambios en la producción de orina?\",\r\n        \"¿Estás tomando medicamentos nefrotóxicos?\",\r\n      ],\r\n      tags: [\"emergencia\", \"renal\", \"función-renal\"],\r\n    },\r\n  },\r\n\r\n  // ========== LÍPIDOS ==========\r\n  {\r\n    id: \"ldl_very_high\",\r\n    enabled: true,\r\n    name: \"LDL muy elevado\",\r\n    when: {\r\n      all: [{ biomarker: \"ldl_c\", op: \">=\", value: 190 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"Colesterol LDL muy elevado: requiere evaluación y posible tratamiento\",\r\n      why: \"LDL ≥ 190 mg/dL se asocia con alto riesgo cardiovascular\",\r\n      doNext: [\r\n        \"Discute con tu médico sobre estrategias para reducir el LDL\",\r\n        \"Considera cambios en dieta (reducir grasas saturadas y trans)\",\r\n        \"Evalúa actividad física regular\",\r\n        \"Tu médico puede recomendar medicamentos según tu riesgo cardiovascular total\",\r\n        \"Repite el perfil lipídico en 3-6 meses para evaluar respuesta\",\r\n      ],\r\n      tags: [\"lípidos\", \"cardiovascular\", \"ldl\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"ldl_high\",\r\n    enabled: true,\r\n    name: \"LDL elevado\",\r\n    when: {\r\n      all: [{ biomarker: \"ldl_c\", op: \"between\", value1: 160, value2: 189 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Colesterol LDL elevado: considera optimización\",\r\n      why: \"LDL entre 160-189 mg/dL está por encima del óptimo\",\r\n      doNext: [\r\n        \"Discute con tu médico tu riesgo cardiovascular global\",\r\n        \"Considera ajustes dietéticos y estilo de vida\",\r\n        \"Mantén o aumenta actividad física regular\",\r\n        \"Repite el perfil lipídico en 6 meses para seguimiento\",\r\n      ],\r\n      tags: [\"lípidos\", \"ldl\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"hdl_low\",\r\n    enabled: true,\r\n    name: \"HDL bajo\",\r\n    when: {\r\n      all: [{ biomarker: \"hdl_c\", op: \"<\", value: 40 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Colesterol HDL bajo: factor de riesgo cardiovascular\",\r\n      why: \"HDL < 40 mg/dL se considera un factor de riesgo cardiovascular\",\r\n      doNext: [\r\n        \"Aumenta actividad física aeróbica regular\",\r\n        \"Considera cambios dietéticos (grasas saludables, reducción de carbohidratos refinados)\",\r\n        \"Si fumas, considera dejar de fumar\",\r\n        \"Discute con tu médico sobre estrategias para elevar HDL\",\r\n      ],\r\n      tags: [\"lípidos\", \"cardiovascular\", \"hdl\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"triglycerides_very_high\",\r\n    enabled: true,\r\n    name: \"Triglicéridos muy elevados\",\r\n    when: {\r\n      all: [{ biomarker: \"triglycerides\", op: \">=\", value: 500 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"Triglicéridos muy elevados: riesgo de pancreatitis\",\r\n      why: \"Triglicéridos ≥ 500 mg/dL aumentan el riesgo de pancreatitis aguda\",\r\n      doNext: [\r\n        \"Consulta con tu médico sobre tratamiento inmediato\",\r\n        \"Reduce significativamente el consumo de alcohol\",\r\n        \"Limita azúcares y carbohidratos refinados\",\r\n        \"Considera medicamentos si tu médico lo indica\",\r\n        \"Repite la prueba en 1-2 meses para evaluar respuesta\",\r\n      ],\r\n      tags: [\"lípidos\", \"triglicéridos\", \"pancreatitis\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"triglycerides_high\",\r\n    enabled: true,\r\n    name: \"Triglicéridos elevados\",\r\n    when: {\r\n      all: [{ biomarker: \"triglycerides\", op: \"between\", value1: 200, value2: 499 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Triglicéridos elevados: optimiza estilo de vida\",\r\n      why: \"Triglicéridos entre 200-499 mg/dL están elevados\",\r\n      doNext: [\r\n        \"Reduce consumo de azúcares y carbohidratos refinados\",\r\n        \"Limita o elimina alcohol\",\r\n        \"Aumenta actividad física regular\",\r\n        \"Discute con tu médico si necesitas medicamentos\",\r\n        \"Repite la prueba en 3-6 meses\",\r\n      ],\r\n      tags: [\"lípidos\", \"triglicéridos\"],\r\n    },\r\n  },\r\n\r\n  // ========== GLUCOSA Y DIABETES ==========\r\n  {\r\n    id: \"glucose_high\",\r\n    enabled: true,\r\n    name: \"Glucosa elevada (no crítica)\",\r\n    when: {\r\n      all: [{ biomarker: \"glucose\", op: \"between\", value1: 126, value2: 399 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"Glucosa elevada: posible diabetes o prediabetes\",\r\n      why: \"Glucosa ≥ 126 mg/dL en ayunas sugiere diabetes o prediabetes\",\r\n      doNext: [\r\n        \"Consulta con tu médico para confirmar el diagnóstico (puede requerir prueba repetida o hemoglobina glicosilada)\",\r\n        \"Considera cambios en dieta (reducir azúcares y carbohidratos refinados)\",\r\n        \"Aumenta actividad física regular\",\r\n        \"Si ya tienes diagnóstico de diabetes, revisa tu plan de tratamiento\",\r\n      ],\r\n      tags: [\"glucosa\", \"diabetes\", \"metabolismo\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"glucose_borderline\",\r\n    enabled: true,\r\n    name: \"Glucosa en rango límite\",\r\n    when: {\r\n      all: [{ biomarker: \"glucose\", op: \"between\", value1: 100, value2: 125 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Glucosa en rango límite: monitoreo recomendado\",\r\n      why: \"Glucosa entre 100-125 mg/dL en ayunas se considera prediabetes\",\r\n      doNext: [\r\n        \"Discute con tu médico sobre seguimiento\",\r\n        \"Considera prueba de hemoglobina glicosilada (A1C)\",\r\n        \"Optimiza dieta y actividad física para prevenir progresión a diabetes\",\r\n        \"Repite glucosa en ayunas en 3-6 meses\",\r\n      ],\r\n      tags: [\"glucosa\", \"prediabetes\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"a1c_diabetes\",\r\n    enabled: true,\r\n    name: \"A1C en rango de diabetes\",\r\n    when: {\r\n      all: [{ biomarker: \"a1c\", op: \">=\", value: 6.5 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"Hemoglobina A1C elevada: posible diabetes\",\r\n      why: \"A1C ≥ 6.5% es diagnóstico de diabetes\",\r\n      doNext: [\r\n        \"Consulta con tu médico para confirmar diagnóstico y establecer plan de tratamiento\",\r\n        \"Considera cambios en dieta y estilo de vida\",\r\n        \"Monitorea glucosa regularmente si tu médico lo indica\",\r\n        \"Evalúa riesgo de complicaciones con tu médico\",\r\n      ],\r\n      tags: [\"diabetes\", \"a1c\", \"metabolismo\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"a1c_prediabetes\",\r\n    enabled: true,\r\n    name: \"A1C en rango de prediabetes\",\r\n    when: {\r\n      all: [{ biomarker: \"a1c\", op: \"between\", value1: 5.7, value2: 6.4 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"A1C en rango de prediabetes: intervención temprana recomendada\",\r\n      why: \"A1C entre 5.7-6.4% indica prediabetes\",\r\n      doNext: [\r\n        \"Discute con tu médico estrategias para prevenir progresión a diabetes\",\r\n        \"Considera programa de cambio de estilo de vida\",\r\n        \"Optimiza dieta (reducir azúcares y carbohidratos refinados)\",\r\n        \"Aumenta actividad física regular\",\r\n        \"Repite A1C en 6 meses para seguimiento\",\r\n      ],\r\n      tags: [\"prediabetes\", \"a1c\"],\r\n    },\r\n  },\r\n\r\n  // ========== TIROIDES ==========\r\n  {\r\n    id: \"tsh_high\",\r\n    enabled: true,\r\n    name: \"TSH elevado (posible hipotiroidismo)\",\r\n    when: {\r\n      all: [{ biomarker: \"tsh\", op: \">=\", value: 4.5 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"TSH elevado: posible hipotiroidismo\",\r\n      why: \"TSH ≥ 4.5 mUI/L sugiere posible hipotiroidismo, especialmente si FT4 está bajo\",\r\n      doNext: [\r\n        \"Consulta con tu médico o endocrinólogo para evaluación completa\",\r\n        \"Si FT4 está bajo, puede ser necesario tratamiento con hormona tiroidea\",\r\n        \"Repite pruebas de función tiroidea en 6-12 semanas para confirmar\",\r\n        \"Menciona síntomas como fatiga, aumento de peso, estreñimiento, sensación de frío\",\r\n      ],\r\n      tags: [\"tiroides\", \"tsh\", \"hipotiroidismo\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"tsh_low\",\r\n    enabled: true,\r\n    name: \"TSH suprimido (posible hipertiroidismo)\",\r\n    when: {\r\n      all: [{ biomarker: \"tsh\", op: \"<\", value: 0.4 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"TSH suprimido: posible hipertiroidismo\",\r\n      why: \"TSH < 0.4 mUI/L sugiere posible hipertiroidismo, especialmente si FT4 está elevado\",\r\n      doNext: [\r\n        \"Consulta con tu médico o endocrinólogo para evaluación\",\r\n        \"Si FT4 está elevado, puede requerir tratamiento\",\r\n        \"Menciona síntomas como palpitaciones, ansiedad, pérdida de peso, sudoración excesiva\",\r\n        \"Repite pruebas de función tiroidea para confirmar\",\r\n      ],\r\n      tags: [\"tiroides\", \"tsh\", \"hipertiroidismo\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"ft4_low\",\r\n    enabled: true,\r\n    name: \"FT4 bajo\",\r\n    when: {\r\n      all: [{ biomarker: \"ft4\", op: \"<\", value: 0.8 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"Tiroxina libre (FT4) baja: hipotiroidismo confirmado o severo\",\r\n      why: \"FT4 < 0.8 ng/dL indica hipotiroidismo, especialmente si TSH está elevado\",\r\n      doNext: [\r\n        \"Consulta urgentemente con endocrinólogo\",\r\n        \"Probablemente requieras tratamiento con levotiroxina\",\r\n        \"Monitorea síntomas de hipotiroidismo\",\r\n        \"Repite pruebas después de iniciar tratamiento según indique tu médico\",\r\n      ],\r\n      tags: [\"tiroides\", \"ft4\", \"hipotiroidismo\"],\r\n    },\r\n  },\r\n\r\n  // ========== VITAMINA D ==========\r\n  {\r\n    id: \"vitamin_d_deficient\",\r\n    enabled: true,\r\n    name: \"Vitamina D deficiente\",\r\n    when: {\r\n      all: [{ biomarker: \"vitamin_d_25oh\", op: \"<\", value: 20 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Vitamina D deficiente: suplementación recomendada\",\r\n      why: \"Vitamina D < 20 ng/mL se considera deficiencia\",\r\n      doNext: [\r\n        \"Discute con tu médico sobre suplementación con vitamina D\",\r\n        \"Considera aumentar exposición solar segura (15-20 min/día)\",\r\n        \"Incluye alimentos ricos en vitamina D en tu dieta\",\r\n        \"Repite la prueba después de 3 meses de suplementación para evaluar respuesta\",\r\n      ],\r\n      tags: [\"vitamina-d\", \"nutrición\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"vitamin_d_insufficient\",\r\n    enabled: true,\r\n    name: \"Vitamina D insuficiente\",\r\n    when: {\r\n      all: [{ biomarker: \"vitamin_d_25oh\", op: \"between\", value1: 20, value2: 29.9 }],\r\n    },\r\n    then: {\r\n      severity: \"green\",\r\n      headline: \"Vitamina D en rango insuficiente: optimización recomendada\",\r\n      why: \"Vitamina D entre 20-29.9 ng/mL se considera insuficiente (óptimo: ≥30)\",\r\n      doNext: [\r\n        \"Considera suplementación moderada con tu médico\",\r\n        \"Aumenta exposición solar segura\",\r\n        \"Incluye alimentos ricos en vitamina D\",\r\n        \"Repite la prueba en 6 meses\",\r\n      ],\r\n      tags: [\"vitamina-d\"],\r\n    },\r\n  },\r\n\r\n  // ========== ANEMIA ==========\r\n  {\r\n    id: \"hemoglobin_low\",\r\n    enabled: true,\r\n    name: \"Hemoglobina baja (posible anemia)\",\r\n    when: {\r\n      all: [{ biomarker: \"hemoglobin\", op: \"<\", value: 12 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Hemoglobina baja: posible anemia\",\r\n      why: \"Hemoglobina < 12 g/dL sugiere anemia (umbral típico para mujeres, considerar 13 g/dL para hombres)\",\r\n      doNext: [\r\n        \"Consulta con tu médico para determinar la causa\",\r\n        \"Si es por deficiencia de hierro, puede requerir suplementación\",\r\n        \"Considera dieta rica en hierro (carnes, legumbres, vegetales de hoja verde)\",\r\n        \"Repite hemograma completo en 1-3 meses después de intervención\",\r\n      ],\r\n      tags: [\"anemia\", \"hemoglobina\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"ferritin_low\",\r\n    enabled: true,\r\n    name: \"Ferritina baja (deficiencia de hierro)\",\r\n    when: {\r\n      all: [{ biomarker: \"ferritin\", op: \"<\", value: 15 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Ferritina baja: depósitos de hierro agotados\",\r\n      why: \"Ferritina < 15 ng/mL indica deficiencia de hierro\",\r\n      doNext: [\r\n        \"Consulta con tu médico sobre suplementación con hierro\",\r\n        \"Considera dieta rica en hierro\",\r\n        \"Si tienes sangrado menstrual abundante, discútelo con tu ginecólogo\",\r\n        \"Repite ferritina después de 2-3 meses de suplementación\",\r\n      ],\r\n      tags: [\"anemia\", \"hierro\", \"ferritina\"],\r\n    },\r\n  },\r\n\r\n  // ========== INFLAMACIÓN ==========\r\n  {\r\n    id: \"hs_crp_high_risk\",\r\n    enabled: true,\r\n    name: \"hs-CRP elevado (alto riesgo cardiovascular)\",\r\n    when: {\r\n      all: [{ biomarker: \"hs_crp\", op: \">\", value: 3.0 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"hs-CRP elevado: mayor riesgo cardiovascular\",\r\n      why: \"hs-CRP > 3.0 mg/L se asocia con mayor riesgo cardiovascular\",\r\n      doNext: [\r\n        \"Discute con tu médico sobre estrategias de reducción de riesgo cardiovascular\",\r\n        \"Optimiza otros factores de riesgo (lípidos, presión arterial, glucosa)\",\r\n        \"Considera cambios en estilo de vida (dieta antiinflamatoria, ejercicio, manejo de estrés)\",\r\n        \"Tu médico puede considerar estatinas según tu riesgo total\",\r\n      ],\r\n      tags: [\"inflamación\", \"cardiovascular\", \"hs-crp\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"hs_crp_moderate_risk\",\r\n    enabled: true,\r\n    name: \"hs-CRP riesgo moderado\",\r\n    when: {\r\n      all: [{ biomarker: \"hs_crp\", op: \"between\", value1: 1.0, value2: 3.0 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"hs-CRP en rango de riesgo moderado\",\r\n      why: \"hs-CRP entre 1.0-3.0 mg/L indica riesgo cardiovascular moderado\",\r\n      doNext: [\r\n        \"Considera optimizar factores de riesgo cardiovascular\",\r\n        \"Mantén estilo de vida saludable (dieta, ejercicio, no fumar)\",\r\n        \"Repite hs-CRP en 6-12 meses si hay otros factores de riesgo\",\r\n      ],\r\n      tags: [\"inflamación\", \"cardiovascular\"],\r\n    },\r\n  },\r\n\r\n  // ========== RENAL ==========\r\n  {\r\n    id: \"egfr_reduced\",\r\n    enabled: true,\r\n    name: \"eGFR reducido (función renal alterada)\",\r\n    when: {\r\n      all: [{ biomarker: \"egfr\", op: \"<\", value: 60 }],\r\n    },\r\n    then: {\r\n      severity: \"orange\",\r\n      headline: \"Función renal reducida: requiere evaluación\",\r\n      why: \"eGFR < 60 mL/min/1.73m² indica función renal reducida (estadios 3-5 de ERC)\",\r\n      doNext: [\r\n        \"Consulta con nefrólogo para evaluación completa\",\r\n        \"Revisa medicamentos que puedan afectar la función renal\",\r\n        \"Monitorea presión arterial regularmente\",\r\n        \"Considera restricciones dietéticas según indique tu médico (proteínas, fósforo, potasio)\",\r\n        \"Repite función renal en 3-6 meses\",\r\n      ],\r\n      tags: [\"renal\", \"egfr\", \"función-renal\"],\r\n    },\r\n  },\r\n  {\r\n    id: \"creatinine_elevated\",\r\n    enabled: true,\r\n    name: \"Creatinina elevada (no crítica)\",\r\n    when: {\r\n      all: [{ biomarker: \"creatinine\", op: \"between\", value1: 1.2, value2: 2.9 }],\r\n    },\r\n    then: {\r\n      severity: \"yellow\",\r\n      headline: \"Creatinina elevada: función renal alterada\",\r\n      why: \"Creatinina entre 1.2-2.9 mg/dL sugiere función renal alterada\",\r\n      doNext: [\r\n        \"Consulta con tu médico para evaluación\",\r\n        \"Revisa medicamentos que puedan afectar la función renal\",\r\n        \"Monitorea presión arterial\",\r\n        \"Mantén hidratación adecuada (si no hay restricción médica)\",\r\n        \"Repite función renal en 3-6 meses\",\r\n      ],\r\n      tags: [\"renal\", \"creatinina\"],\r\n    },\r\n  },\r\n];\r\n\r\n","import { Condition, LabInput, Rule, FiredRule, ReportOutput, Severity } from \"./types\";\r\n\r\n/**\r\n * Obtiene el valor numérico de un biomarcador, o null si está ausente/inválido\r\n */\r\nexport function getValue(input: LabInput, biomarker: string): number | null {\r\n  const value = input.labs[biomarker];\r\n  if (value === null || value === undefined || typeof value !== \"number\" || isNaN(value)) {\r\n    return null;\r\n  }\r\n  return value;\r\n}\r\n\r\n/**\r\n * Evalúa una condición individual y retorna si se cumple y por qué\r\n */\r\nexport function evalCondition(\r\n  input: LabInput,\r\n  condition: Condition\r\n): { ok: boolean; because: string } {\r\n  const { biomarker, op } = condition;\r\n  const value = getValue(input, biomarker);\r\n\r\n  if (op === \"exists\") {\r\n    const exists = value !== null;\r\n    return {\r\n      ok: exists,\r\n      because: exists\r\n        ? `${biomarker} está presente (valor: ${value})`\r\n        : `${biomarker} no está presente`,\r\n    };\r\n  }\r\n\r\n  if (value === null) {\r\n    return {\r\n      ok: false,\r\n      because: `${biomarker} no está presente`,\r\n    };\r\n  }\r\n\r\n  if (op === \"between\") {\r\n    const { value1, value2 } = condition;\r\n    const min = Math.min(value1, value2);\r\n    const max = Math.max(value1, value2);\r\n    const ok = value >= min && value <= max;\r\n    return {\r\n      ok,\r\n      because: ok\r\n        ? `${biomarker} (${value}) está entre ${min} y ${max}`\r\n        : `${biomarker} (${value}) NO está entre ${min} y ${max}`,\r\n    };\r\n  }\r\n\r\n  // Operadores de comparación: >, >=, <, <=\r\n  const { value: threshold } = condition;\r\n  let ok = false;\r\n  let comparison = \"\";\r\n\r\n  switch (op) {\r\n    case \">\":\r\n      ok = value > threshold;\r\n      comparison = \"mayor que\";\r\n      break;\r\n    case \">=\":\r\n      ok = value >= threshold;\r\n      comparison = \"mayor o igual que\";\r\n      break;\r\n    case \"<\":\r\n      ok = value < threshold;\r\n      comparison = \"menor que\";\r\n      break;\r\n    case \"<=\":\r\n      ok = value <= threshold;\r\n      comparison = \"menor o igual que\";\r\n      break;\r\n  }\r\n\r\n  return {\r\n    ok,\r\n    because: `${biomarker} (${value}) ${ok ? \"es\" : \"NO es\"} ${comparison} ${threshold}`,\r\n  };\r\n}\r\n\r\n/**\r\n * Evalúa una regla completa y retorna si se disparó y por qué\r\n */\r\nexport function evalRule(input: LabInput, rule: Rule): FiredRule | null {\r\n  if (!rule.enabled) {\r\n    return null;\r\n  }\r\n\r\n  const { all, any } = rule.when;\r\n  const firedBecause: string[] = [];\r\n  let ruleFired = false;\r\n\r\n  // Evalúa condiciones \"all\"\r\n  if (all && all.length > 0) {\r\n    const allResults = all.map((cond) => evalCondition(input, cond));\r\n    const allOk = allResults.every((r) => r.ok);\r\n    allResults.forEach((r) => firedBecause.push(r.because));\r\n    if (!allOk) {\r\n      return null; // Si \"all\" falla, la regla no se dispara\r\n    }\r\n    ruleFired = true;\r\n  }\r\n\r\n  // Evalúa condiciones \"any\"\r\n  if (any && any.length > 0) {\r\n    const anyResults = any.map((cond) => evalCondition(input, cond));\r\n    const anyOk = anyResults.some((r) => r.ok);\r\n    anyResults.forEach((r) => firedBecause.push(r.because));\r\n    if (anyOk) {\r\n      ruleFired = true;\r\n    } else if (!all) {\r\n      // Si no hay \"all\" y \"any\" falla, la regla no se dispara\r\n      return null;\r\n    }\r\n  }\r\n\r\n  if (!ruleFired) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    ...rule,\r\n    firedBecause,\r\n  };\r\n}\r\n\r\n/**\r\n * Orden de severidad para ordenamiento\r\n */\r\nconst severityOrder: Record<Severity, number> = {\r\n  red: 4,\r\n  orange: 3,\r\n  yellow: 2,\r\n  green: 1,\r\n};\r\n\r\n/**\r\n * Genera un reporte a partir de input y reglas\r\n */\r\nexport function generateReport(input: LabInput, rules: Rule[]): ReportOutput {\r\n  // Evalúa todas las reglas\r\n  const firedRules: FiredRule[] = [];\r\n  for (const rule of rules) {\r\n    const result = evalRule(input, rule);\r\n    if (result) {\r\n      firedRules.push(result);\r\n    }\r\n  }\r\n\r\n  // Ordena por severidad (red > orange > yellow > green)\r\n  firedRules.sort((a, b) => {\r\n    return severityOrder[b.then.severity] - severityOrder[a.then.severity];\r\n  });\r\n\r\n  // Construye acciones desde las reglas disparadas\r\n  const actions = firedRules.map((rule) => ({\r\n    severity: rule.then.severity,\r\n    headline: rule.then.headline,\r\n    bullets: rule.then.doNext,\r\n  }));\r\n\r\n  return {\r\n    priorities: firedRules,\r\n    actions,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":"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"}